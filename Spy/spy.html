<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Keys.so - –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤</title>
    
    <!-- CSS –º–æ–¥—É–ª–∏ -->
    <link rel="stylesheet" href="assets/css/main.css?v=3.0">
    <link rel="stylesheet" href="assets/css/sidebar.css?v=3.1">
    <link rel="stylesheet" href="assets/css/modal.css?v=3.0">
    <link rel="stylesheet" href="assets/css/tables.css?v=3.0">
</head>
<body>

<!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –¥–æ–º–µ–Ω–∞–º–∏ -->
<div class="sidebar">
    <h2>
        üìÅ –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã
        <span id="domainCounter">0</span>
    </h2>

    <div class="sidebar-actions">
        <button class="sidebar-btn" id="addDomainBtn">+ –î–æ–±–∞–≤–∏—Ç—å</button>
        <div class="action-icons">
            <button class="action-icon-btn" id="exportDomainsBtn" title="–≠–∫—Å–ø–æ—Ä—Ç –¥–æ–º–µ–Ω–æ–≤">‚¨áÔ∏è</button>
            <button class="action-icon-btn" id="importDomainsBtn" title="–ò–º–ø–æ—Ä—Ç –¥–æ–º–µ–Ω–æ–≤">‚¨ÜÔ∏è</button>
            <button class="action-icon-btn" id="manageTagsBtn" title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–∞–º–∏">üè∑Ô∏è</button>
            <button class="action-icon-btn" id="restoreDataBtn" title="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ">üîÑ</button>
            <button class="action-icon-btn" id="loadDefaultDomainsBtn" title="–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–º–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é">üè†</button>
            <button class="action-icon-btn" id="syncDataBtn" title="–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ">üîÑ</button>
            <button class="action-icon-btn" id="showAllDomainsBtn" title="–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–æ–º–µ–Ω—ã" style="display: none;">üîÑ</button>
        </div>
    </div>
    
    <div class="domain-search-container">
        <div class="search-input-wrapper">
            <input type="text" id="domainSearchInput" placeholder="üîç –ü–æ–∏—Å–∫ –¥–æ–º–µ–Ω–æ–≤ (—ã–µ—É—É–¥–∏–∫—â ‚Üí steelbro)" class="domain-search-input">
            <button class="search-clear-btn" id="searchClearBtn" title="–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫">√ó</button>
        </div>
    </div>
    

    <div class="domain-list" id="domainList">
        <div class="empty-state">
            <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤</p>
            <p style="font-size: 12px; margin-top: 10px;">–î–æ–±–∞–≤—å—Ç–µ –¥–æ–º–µ–Ω—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞</p>
        </div>
    </div>
</div>

<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
<div class="main-content">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="header">
        <h1>üîç Keys.so - –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤</h1>

        <div class="api-status">
            <div class="api-indicator" id="apiIndicator"></div>
            <span id="apiStatusText">API —Å—Ç–∞—Ç—É—Å</span>
            <button class="api-check-btn" id="checkApiBtn" style="padding:6px 12px;background:#fff;border:1px solid #ddd;border-radius:6px;cursor:pointer;font-size:13px;margin-left:auto;">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        </div>

        <form class="search-form" id="searchForm">
            <input type="text" id="domainInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä: dns-shop.ru)" required>
            <select id="regionSelect">
                <option value="ekb" selected>–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥</option>
                <option value="msk">–ú–æ—Å–∫–≤–∞</option>
                <option value="nsk">–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫</option>
                <option value="kzn">–ö–∞–∑–∞–Ω—å</option>
                <option value="tyumen">–¢—é–º–µ–Ω—å</option>
                <option value="perm">–ü–µ—Ä–º—å</option>
                <option value="chelyabinsk">–ß–µ–ª—è–±–∏–Ω—Å–∫</option>
            </select>
            <button type="submit" id="analyzeBtn">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>
            <button type="button" id="analyzeAllCitiesBtn" class="analyze-all-btn">üåç –í—Å–µ –≥–æ—Ä–æ–¥–∞</button>
        </form>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö -->
    <div id="errorMessage"></div>

    <!-- –í–∫–ª–∞–¥–∫–∏ -->
    <div class="tabs">
        <button class="tab active" data-tab="overview">üìä –û–±–∑–æ—Ä</button>
        <button class="tab" data-tab="organic">üå± –û—Ä–≥–∞–Ω–∏–∫–∞</button>
        <button class="tab" data-tab="links">üîó –°—Å—ã–ª–∫–∏</button>
        <button class="tab" data-tab="advertising">üí∞ –†–µ–∫–ª–∞–º–∞</button>
        <button class="tab" data-tab="keywords">üîë –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞</button>
        <button class="tab" data-tab="pages">üìÑ –°—Ç—Ä–∞–Ω–∏—Ü—ã</button>
        <button class="tab" data-tab="competitors">ü•ä –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã</button>
    </div>

    <!-- –°–µ–∫—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
    <div id="overview" class="content-section active">
        <div id="overviewContent"></div>
    </div>

    <div id="organic" class="content-section">
        <div id="organicContent"></div>
    </div>

    <div id="links" class="content-section">
        <div id="linksContent"></div>
    </div>

    <div id="advertising" class="content-section">
        <div id="advertisingContent"></div>
    </div>

    <div id="keywords" class="content-section">
        <div id="keywordsContent"></div>
    </div>

    <div id="pages" class="content-section">
        <div id="pagesContent"></div>
    </div>

    <div id="competitors" class="content-section">
        <div id="competitorsContent"></div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–º–µ–Ω–æ–≤ -->
<div class="modal" id="domainModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å –¥–æ–º–µ–Ω</h3>
            <button class="close-modal" id="closeModalBtn">√ó</button>
        </div>

        <div class="form-group">
            <label for="modalDomainInput">–î–æ–º–µ–Ω *</label>
            <input type="text" id="modalDomainInput" placeholder="example.com" required>
        </div>

        <div class="form-group">
            <label for="modalDescriptionInput">–û–ø–∏—Å–∞–Ω–∏–µ</label>
            <textarea id="modalDescriptionInput" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–æ–º–µ–Ω–∞ –∏–ª–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞"></textarea>
        </div>

        <div class="form-group">
            <label>–¢–µ–≥–∏</label>
            <div class="tags-input-container" id="tagsContainer">
                <input type="text" class="tags-input" id="tagsInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–≥ –∏ –Ω–∞–∂–º–∏—Ç–µ Enter">
            </div>
        </div>

        <div class="modal-actions">
            <button class="modal-btn secondary" id="cancelModalBtn">–û—Ç–º–µ–Ω–∞</button>
            <button class="modal-btn primary" id="saveDomainBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è —Ç–µ–≥–∞ -->
<div class="modal" id="confirmDeleteTagModal">
    <div class="modal-content confirm-modal">
        <div class="modal-header">
            <h3 id="confirmDeleteTagTitle">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ</h3>
            <button class="close-modal" onclick="hideConfirmDeleteTagModal()">√ó</button>
        </div>
        <div class="modal-body">
            <div class="confirm-icon">‚ö†Ô∏è</div>
            <div class="confirm-message" id="confirmDeleteTagMessage">
                –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–µ–≥?
            </div>
            <div class="confirm-details" id="confirmDeleteTagDetails">
                <!-- –î–µ—Ç–∞–ª–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
        <div class="modal-footer">
            <button class="modal-btn secondary" onclick="hideConfirmDeleteTagModal()">–û—Ç–º–µ–Ω–∞</button>
            <button class="modal-btn huge-danger" id="confirmDeleteTagBtn">üóëÔ∏è –£–î–ê–õ–ò–¢–¨ –¢–ï–ì</button>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–≥–∞–º–∏ -->
<div class="modal" id="tagsManagementModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–∞–º–∏</h3>
            <button class="close-modal" onclick="hideTagsManagementModal()">√ó</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–µ–≥</label>
                <div class="tag-creation-container">
                    <input type="text" id="newTagInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–≥–∞" class="tags-input">
                    <button class="modal-btn primary" id="createTagBtn">–°–æ–∑–¥–∞—Ç—å —Ç–µ–≥</button>
                </div>
            </div>
            <div class="form-group">
                <label>–í—Å–µ —Ç–µ–≥–∏</label>
                <div id="allTagsContainer" class="all-tags-container">
                    <!-- –¢–µ–≥–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
            
            <!-- –ü–∞–ª–∏—Ç—Ä–∞ —Ü–≤–µ—Ç–æ–≤ –¥–ª—è —Ç–µ–≥–æ–≤ -->
            <div id="tagColorPalette" class="tag-color-palette" style="display: none;">
                <div class="color-palette-header">
                    <h4>–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç –¥–ª—è —Ç–µ–≥–∞</h4>
                    <button class="close-color-palette" onclick="hideTagColorPalette()">√ó</button>
                </div>
                <div class="color-palette-content">
                    <div class="preset-colors">
                        <div class="color-option" data-color="#667eea" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" title="–°–∏–Ω–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"></div>
                        <div class="color-option" data-color="#f093fb" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);" title="–†–æ–∑–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"></div>
                        <div class="color-option" data-color="#4facfe" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);" title="–ì–æ–ª—É–±–æ–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"></div>
                        <div class="color-option" data-color="#43e97b" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);" title="–ó–µ–ª–µ–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"></div>
                        <div class="color-option" data-color="#fa709a" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);" title="–û—Ä–∞–Ω–∂–µ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"></div>
                        <div class="color-option" data-color="#a8edea" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);" title="–ú—è—Ç–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"></div>
                        <div class="color-option" data-color="#ff6b6b" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);" title="–ö—Ä–∞—Å–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"></div>
                        <div class="color-option" data-color="#4834d4" style="background: linear-gradient(135deg, #4834d4 0%, #686de0 100%);" title="–§–∏–æ–ª–µ—Ç–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"></div>
                        <div class="color-option" data-color="#00d2d3" style="background: linear-gradient(135deg, #00d2d3 0%, #54a0ff 100%);" title="–ë–∏—Ä—é–∑–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"></div>
                        <div class="color-option" data-color="#ff9ff3" style="background: linear-gradient(135deg, #ff9ff3 0%, #f368e0 100%);" title="–†–æ–∑–æ–≤–æ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"></div>
                        <div class="color-option" data-color="#feca57" style="background: linear-gradient(135deg, #feca57 0%, #ff9ff3 100%);" title="–ñ–µ–ª—Ç–æ-—Ä–æ–∑–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"></div>
                        <div class="color-option" data-color="#48dbfb" style="background: linear-gradient(135deg, #48dbfb 0%, #0abde3 100%);" title="–ù–µ–±–µ—Å–Ω–æ-–≥–æ–ª—É–±–æ–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"></div>
                        <div class="color-option" data-color="#1dd1a1" style="background: linear-gradient(135deg, #1dd1a1 0%, #55efc4 100%);" title="–ò–∑—É–º—Ä—É–¥–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"></div>
                    </div>
                    
                    <div class="saved-colors-section">
                        <div class="saved-colors-header">
                            <label>–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞:</label>
                            <button class="clear-saved-colors" id="clearSavedColors" title="–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞">üóëÔ∏è</button>
                        </div>
                        <div id="savedColorsContainer" class="saved-colors">
                            <!-- –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ü–≤–µ—Ç–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                    
                    <div class="custom-color-section">
                        <label>–°–≤–æ–π —Ü–≤–µ—Ç:</label>
                        <div class="custom-color-input">
                            <input type="color" id="customTagColor" value="#667eea">
                            <button class="modal-btn primary" id="applyCustomColor">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                            <button class="modal-btn secondary" id="saveCustomColor" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ü–≤–µ—Ç –≤ –ø–∞–ª–∏—Ç—Ä—É">üíæ</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="modal-btn secondary" onclick="hideTagsManagementModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>
</div>

<!-- –°–∫—Ä—ã—Ç—ã–π input –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Ñ–∞–π–ª–æ–≤ -->
<input type="file" id="importFileInput" style="display: none;" accept=".json">

<!-- JavaScript –º–æ–¥—É–ª–∏ -->
<!-- –£—Ç–∏–ª–∏—Ç—ã -->
<script src="assets/js/utils.js"></script>

<!-- API -->
<script src="assets/js/api.js?v=2.9"></script>

<!-- Domain Manager -->
<script src="classes/DomainManager/DomainStorage.js?v=3.0"></script>
<script src="classes/DomainManager/DomainUI.js?v=3.0"></script>
<script src="classes/DomainManager/DomainManager.js?v=3.0"></script>

<!-- Shared -->
<script src="classes/Shared/TabManager.js"></script>
<script src="classes/Shared/ExportManager.js"></script>
<script src="classes/Shared/NotificationManager.js"></script>

<!-- Tabs -->
<script src="classes/Overview/OverviewTab.js"></script>
<script src="classes/Keywords/KeywordsTab.js"></script>
<script src="classes/Pages/PagesTab.js"></script>
<script src="classes/Competitors/CompetitorsTab.js"></script>

<!-- Main App (–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º) -->
<script src="assets/js/app.js"></script>

<script>
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
document.addEventListener('DOMContentLoaded', function() {
    console.log('Keys.so Spy - –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
    if (typeof Utils === 'undefined') {
        console.error('Utils –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
    }
    if (typeof DomainStorage === 'undefined') {
        console.error('DomainStorage –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
    }
    if (typeof DomainUI === 'undefined') {
        console.error('DomainUI –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
    }
    if (typeof DomainManager === 'undefined') {
        console.error('DomainManager –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
    }
    if (typeof TabManager === 'undefined') {
        console.error('TabManager –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
    }
    if (typeof ExportManager === 'undefined') {
        console.error('ExportManager –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
    }
    if (typeof NotificationManager === 'undefined') {
        console.error('NotificationManager –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
    }
    if (typeof OverviewTab === 'undefined') {
        console.error('OverviewTab –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
    }
    if (typeof KeywordsTab === 'undefined') {
        console.error('KeywordsTab –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
    }
    
    console.log('–í—Å–µ –º–æ–¥—É–ª–∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º localStorage –ø–µ—Ä–µ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π
    console.log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º localStorage...');
    try {
        const storedDomains = localStorage.getItem('keyso_saved_domains');
        console.log('üì¶ –î–∞–Ω–Ω—ã–µ –≤ localStorage:', storedDomains ? '–Ω–∞–π–¥–µ–Ω—ã' : '–Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
        if (storedDomains) {
            const domains = JSON.parse(storedDomains);
            console.log('üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–º–µ–Ω–æ–≤ –≤ localStorage:', domains.length);
        }
    } catch (e) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ localStorage:', e);
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π
    try {
        console.log('üîß –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –º–æ–¥—É–ª–µ–π...');
        
        // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –º–æ–¥—É–ª–µ–π
        const domainStorage = new DomainStorage();
        console.log('‚úÖ DomainStorage —Å–æ–∑–¥–∞–Ω');
        
        const domainUI = new DomainUI();
        console.log('‚úÖ DomainUI —Å–æ–∑–¥–∞–Ω');
        
        const domainManager = new DomainManager(domainStorage, domainUI);
        console.log('‚úÖ DomainManager —Å–æ–∑–¥–∞–Ω');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ storage
        const domains = domainStorage.getAllDomains();
        console.log('üìä –î–æ–º–µ–Ω–æ–≤ –≤ storage:', domains.length);
        console.log('üìä –î–æ–º–µ–Ω—ã:', domains);
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º UI
        console.log('üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º UI...');
        domainUI.init();
        console.log('‚úÖ UI –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä –¥–æ–º–µ–Ω–æ–≤
        console.log('üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä –¥–æ–º–µ–Ω–æ–≤...');
        domainManager.init();
        console.log('‚úÖ –ú–µ–Ω–µ–¥–∂–µ—Ä –¥–æ–º–µ–Ω–æ–≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        
        // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –∫ —Ñ—É–Ω–∫—Ü–∏—è–º
        const addDomainBtn = document.getElementById('addDomainBtn');
        const exportDomainsBtn = document.getElementById('exportDomainsBtn');
        const importDomainsBtn = document.getElementById('importDomainsBtn');
        
        if (addDomainBtn) {
            addDomainBtn.addEventListener('click', () => {
                domainUI.addDomain();
            });
        }
        
        if (exportDomainsBtn) {
            exportDomainsBtn.addEventListener('click', () => {
                domainUI.exportDomains();
            });
        }
        
        if (importDomainsBtn) {
            importDomainsBtn.addEventListener('click', () => {
                domainUI.importDomains();
            });
        }
        
        // –ö–Ω–æ–ø–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        const restoreDataBtn = document.getElementById('restoreDataBtn');
        if (restoreDataBtn) {
            restoreDataBtn.addEventListener('click', () => {
                console.log('üîÑ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ...');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º localStorage
                const storedDomains = localStorage.getItem('keyso_saved_domains');
                if (storedDomains) {
                    try {
                        const domains = JSON.parse(storedDomains);
                        console.log('üìä –ù–∞–π–¥–µ–Ω–æ –¥–æ–º–µ–Ω–æ–≤ –≤ localStorage:', domains.length);
                        
                        // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ storage
                        domainStorage.loadFromStorage();
                        const reloadedDomains = domainStorage.getAllDomains();
                        console.log('üìä –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–æ –¥–æ–º–µ–Ω–æ–≤:', reloadedDomains.length);
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º UI
                        domainUI.renderDomainList(reloadedDomains);
                        domainUI.updateCounter(reloadedDomains.length);
                        
                        alert(`‚úÖ –î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã! –ù–∞–π–¥–µ–Ω–æ ${reloadedDomains.length} –¥–æ–º–µ–Ω–æ–≤.`);
                    } catch (e) {
                        console.error('‚ùå –û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', e);
                        alert('‚ùå –û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö: ' + e.message);
                    }
                } else {
                    console.log('üì¶ –î–∞–Ω–Ω—ã–µ –≤ localStorage –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                    alert('‚ùå –î–∞–Ω–Ω—ã–µ –≤ localStorage –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ–º–µ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞.');
                }
            });
        }
        
        
        
        // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        const closeModalBtn = document.getElementById('closeModalBtn');
        const cancelModalBtn = document.getElementById('cancelModalBtn');
        const saveDomainBtn = document.getElementById('saveDomainBtn');
        
        if (closeModalBtn) {
            closeModalBtn.addEventListener('click', () => {
                domainUI.hideDomainModal();
            });
        }
        
        if (cancelModalBtn) {
            cancelModalBtn.addEventListener('click', () => {
                domainUI.hideDomainModal();
            });
        }
        
        if (saveDomainBtn) {
            saveDomainBtn.addEventListener('click', () => {
                domainUI.saveDomain();
            });
        }
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        domainManager.on('notification', (data) => {
            if (typeof notificationManager !== 'undefined') {
                notificationManager[data.type](data.message);
            } else {
                console.log(`–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: ${data.type} - ${data.message}`);
            }
        });
        
        // –í–ê–ñ–ù–û: –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è domainSelected
        domainManager.on('domainSelected', (domain) => {
            console.log('–û–±—Ä–∞–±–æ—Ç—á–∏–∫ domainSelected –≤—ã–∑–≤–∞–Ω —Å –¥–æ–º–µ–Ω–æ–º:', domain);
            
            // –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –¥–æ–º–µ–Ω –≤ –ø–æ–∏—Å–∫–æ–≤—É—é —Å—Ç—Ä–æ–∫—É
            const domainInput = document.getElementById('domainInput');
            if (domainInput) {
                domainInput.value = domain.domain;
                console.log('–î–æ–º–µ–Ω –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ –ø–æ–ª–µ:', domain.domain);
            }
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∞–ª–∏–∑
            const analyzeBtn = document.getElementById('analyzeBtn');
            if (analyzeBtn) {
                analyzeBtn.click();
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            console.log(`–í—ã–±—Ä–∞–Ω –¥–æ–º–µ–Ω: ${domain.domain}`);
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è API —Å—Ç–∞—Ç—É—Å–∞
        initializeApiStatus();
        
        console.log('‚úÖ –ú–æ–¥—É–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ');
        
    } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥—É–ª–µ–π:', error);
        
        // Fallback - –ø—Ä–æ—Å—Ç—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
        const addDomainBtn = document.getElementById('addDomainBtn');
        if (addDomainBtn) {
            addDomainBtn.addEventListener('click', () => {
                alert('–ú–æ–¥—É–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏.');
            });
        }
    }
});

// –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ API —Å—Ç–∞—Ç—É—Å–∞
function initializeApiStatus() {
    const apiIndicator = document.getElementById('apiIndicator');
    const apiStatusText = document.getElementById('apiStatusText');
    const checkApiBtn = document.getElementById('checkApiBtn');
    
    if (!apiIndicator || !apiStatusText || !checkApiBtn) {
        console.error('–≠–ª–µ–º–µ–Ω—Ç—ã API —Å—Ç–∞—Ç—É—Å–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
        return;
    }
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å
    setApiStatus('unknown', 'API —Å—Ç–∞—Ç—É—Å');
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
    checkApiBtn.addEventListener('click', checkApiStatus);
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    setTimeout(checkApiStatus, 1000);
}

// –§—É–Ω–∫—Ü–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ API
function setApiStatus(status, text) {
    const apiIndicator = document.getElementById('apiIndicator');
    const apiStatusText = document.getElementById('apiStatusText');
    
    if (!apiIndicator || !apiStatusText) return;
    
    // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–ª–∞—Å—Å—ã —Å—Ç–∞—Ç—É—Å–∞ (–Ω–æ–≤—ã–µ –∏ –ª–µ–≥–∞—Å–∏)
    apiIndicator.classList.remove('api-status-unknown', 'api-status-checking', 'api-status-success', 'api-status-error', 'checking', 'success', 'error');
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–ª–∞—Å—Å
    apiIndicator.classList.add(`api-status-${status}`);
    apiStatusText.textContent = text;
    
    console.log(`API —Å—Ç–∞—Ç—É—Å: ${status} - ${text}`);
}

// –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ API —Å—Ç–∞—Ç—É—Å–∞
async function checkApiStatus() {
    setApiStatus('checking', '–ü—Ä–æ–≤–µ—Ä—è–µ–º...');
    try {
        // –î–µ—Ä–≥–∞–µ–º –∫–æ—Ä–Ω–µ–≤–æ–π –ø—Ä–æ–∫—Å–∏ —Å GET-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–µ–π OpenAPI)
        const url = '/keys_proxy.php?endpoint=/report/simple/domain_dashboard&domain=yandex.ru&base=msk';
        const response = await fetch(url, { method: 'GET' });

        if (response.ok) {
            setApiStatus('success', 'API —Ä–∞–±–æ—Ç–∞–µ—Ç');
            console.log('‚úÖ API –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞');
            return;
        }

        setApiStatus('error', '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è');
        console.log('‚ùå –û—à–∏–±–∫–∞ HTTP:', response.status);
    } catch (error) {
        setApiStatus('error', 'API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
        console.log('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ API:', error.message);
    }
}

// –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
function hideConfirmDeleteTagModal() {
    if (window.domainUI) {
        window.domainUI.hideConfirmDeleteTagModal();
    }
}

// –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–≥–∞–º–∏
function hideTagsManagementModal() {
    if (window.domainUI) {
        window.domainUI.hideTagsManagementModal();
    }
}

// –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –ø–∞–ª–∏—Ç—Ä—ã —Ü–≤–µ—Ç–æ–≤
function hideTagColorPalette() {
    if (window.domainUI) {
        window.domainUI.hideTagColorPalette();
    }
}
</script>

</body>
</html>
