<!-- File: Spy/debug_tags.html -->
<!-- Created: 2025-01-22 -->
<!-- Modified: 2025-01-22 -->

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç–ª–∞–¥–∫–∞ —Ç–µ–≥–æ–≤ - SteelBro</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        
        .debug-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .debug-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        
        .debug-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
        
        .debug-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            margin-bottom: 10px;
            white-space: pre-wrap;
        }
        
        .debug-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        .debug-button:hover {
            background: #5a6fd8;
        }
        
        .domain-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background: white;
        }
        
        .domain-name {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 8px;
        }
        
        .domain-description {
            color: #666;
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .domain-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .tag {
            background: #667eea;
            color: #fff;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .tag:hover {
            background: #5a6fd8;
            transform: scale(1.05);
        }
        
        .error {
            color: #d32f2f;
            background: #ffebee;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .success {
            color: #2e7d32;
            background: #e8f5e8;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1>üîç –û—Ç–ª–∞–¥–∫–∞ —Ç–µ–≥–æ–≤ –≤ SteelBro</h1>
        
        <div class="debug-section">
            <div class="debug-title">1. –ü—Ä–æ–≤–µ—Ä–∫–∞ localStorage</div>
            <button class="debug-button" onclick="checkLocalStorage()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å localStorage</button>
            <button class="debug-button" onclick="clearLocalStorage()">–û—á–∏—Å—Ç–∏—Ç—å localStorage</button>
            <div id="localStorageInfo" class="debug-info"></div>
        </div>
        
        <div class="debug-section">
            <div class="debug-title">2. –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–º–µ–Ω–∞ —Å —Ç–µ–≥–∞–º–∏</div>
            <button class="debug-button" onclick="createTestDomain()">–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ–º–µ–Ω</button>
            <button class="debug-button" onclick="createMultipleTestDomains()">–°–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–æ–º–µ–Ω–æ–≤</button>
            <div id="createDomainInfo" class="debug-info"></div>
        </div>
        
        <div class="debug-section">
            <div class="debug-title">3. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–º–µ–Ω–æ–≤</div>
            <button class="debug-button" onclick="displayDomains()">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–æ–º–µ–Ω—ã</button>
            <button class="debug-button" onclick="displayDomainsWithTags()">–ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–æ–º–µ–Ω—ã —Å —Ç–µ–≥–∞–º–∏</button>
            <div id="domainsDisplay"></div>
        </div>
        
        <div class="debug-section">
            <div class="debug-title">4. –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–π DomainStorage</div>
            <button class="debug-button" onclick="testDomainStorage()">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å DomainStorage</button>
            <div id="domainStorageInfo" class="debug-info"></div>
        </div>
        
        <div class="debug-section">
            <div class="debug-title">5. –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–π DomainUI</div>
            <button class="debug-button" onclick="testDomainUI()">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å DomainUI</button>
            <div id="domainUIInfo" class="debug-info"></div>
        </div>
        
        <div class="debug-section">
            <div class="debug-title">6. –ü—Ä–æ–≤–µ—Ä–∫–∞ CSS</div>
            <button class="debug-button" onclick="checkCSS()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å CSS</button>
            <div id="cssInfo" class="debug-info"></div>
        </div>
        
        <div class="debug-section">
            <div class="debug-title">7. –¢–µ—Å—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–≥–æ–≤</div>
            <button class="debug-button" onclick="testTagDisplay()">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–≥–æ–≤</button>
            <div id="tagDisplayTest"></div>
        </div>
    </div>
    
    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ localStorage
        function checkLocalStorage() {
            const info = document.getElementById('localStorageInfo');
            const domains = JSON.parse(localStorage.getItem('domains') || '[]');
            
            info.textContent = `–î–æ–º–µ–Ω–æ–≤ –≤ localStorage: ${domains.length}\n\n` +
                domains.map((domain, index) => 
                    `${index + 1}. ${domain.domain}\n` +
                    `   ID: ${domain.id}\n` +
                    `   –¢–µ–≥–∏: ${JSON.stringify(domain.tags || [])}\n` +
                    `   –û–ø–∏—Å–∞–Ω–∏–µ: ${domain.description || '–Ω–µ—Ç'}\n` +
                    `   –°–æ–∑–¥–∞–Ω: ${domain.createdAt}\n` +
                    `   –û–±–Ω–æ–≤–ª–µ–Ω: ${domain.updatedAt}\n`
                ).join('\n');
        }
        
        // –û—á–∏—Å—Ç–∫–∞ localStorage
        function clearLocalStorage() {
            localStorage.removeItem('domains');
            document.getElementById('localStorageInfo').textContent = 'localStorage –æ—á–∏—â–µ–Ω';
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –¥–æ–º–µ–Ω–∞
        function createTestDomain() {
            const testDomain = {
                id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                domain: 'test-domain.com',
                description: '–¢–µ—Å—Ç–æ–≤—ã–π –¥–æ–º–µ–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ–≥–æ–≤',
                tags: ['—Ç–µ—Å—Ç', '–ø—Ä–∏–º–µ—Ä', '–º–µ—Ç–∞–ª–ª', '–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏'],
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            const domains = JSON.parse(localStorage.getItem('domains') || '[]');
            domains.unshift(testDomain);
            localStorage.setItem('domains', JSON.stringify(domains));
            
            document.getElementById('createDomainInfo').textContent = 
                '–¢–µ—Å—Ç–æ–≤—ã–π –¥–æ–º–µ–Ω —Å–æ–∑–¥–∞–Ω:\n' + JSON.stringify(testDomain, null, 2);
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–æ–º–µ–Ω–æ–≤
        function createMultipleTestDomains() {
            const testDomains = [
                {
                    id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                    domain: 'metal-company.ru',
                    description: '–ö–æ–º–ø–∞–Ω–∏—è –ø–æ –º–µ—Ç–∞–ª–ª–æ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º',
                    tags: ['–º–µ—Ç–∞–ª–ª', '–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏', '–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ'],
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                },
                {
                    id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                    domain: 'steel-supplier.com',
                    description: '–ü–æ—Å—Ç–∞–≤—â–∏–∫ —Å—Ç–∞–ª–∏',
                    tags: ['—Å—Ç–∞–ª—å', '–ø–æ—Å—Ç–∞–≤–∫–∏', '–æ–ø—Ç'],
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                },
                {
                    id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                    domain: 'construction-firm.org',
                    description: '–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏—Ä–º–∞',
                    tags: ['—Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ', '–º–æ–Ω—Ç–∞–∂', '—É—Å–ª—É–≥–∏'],
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                },
                {
                    id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                    domain: 'no-tags.com',
                    description: '–î–æ–º–µ–Ω –±–µ–∑ —Ç–µ–≥–æ–≤',
                    tags: [],
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                }
            ];
            
            const domains = JSON.parse(localStorage.getItem('domains') || '[]');
            testDomains.forEach(domain => domains.unshift(domain));
            localStorage.setItem('domains', JSON.stringify(domains));
            
            document.getElementById('createDomainInfo').textContent = 
                '–°–æ–∑–¥–∞–Ω–æ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–æ–º–µ–Ω–æ–≤: ' + testDomains.length;
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–º–µ–Ω–æ–≤
        function displayDomains() {
            const domains = JSON.parse(localStorage.getItem('domains') || '[]');
            const container = document.getElementById('domainsDisplay');
            
            if (domains.length === 0) {
                container.innerHTML = '<div class="error">–î–æ–º–µ–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }
            
            const html = domains.map(domain => `
                <div class="domain-card">
                    <div class="domain-name">${domain.domain}</div>
                    ${domain.description ? `<div class="domain-description">${domain.description}</div>` : ''}
                    ${domain.tags && domain.tags.length > 0 ? `
                        <div class="domain-tags">
                            ${domain.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                    ` : '<div style="color: #999; font-size: 12px;">–ù–µ—Ç —Ç–µ–≥–æ–≤</div>'}
                </div>
            `).join('');
            
            container.innerHTML = html;
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–æ–º–µ–Ω–æ–≤ —Å —Ç–µ–≥–∞–º–∏
        function displayDomainsWithTags() {
            const domains = JSON.parse(localStorage.getItem('domains') || '[]');
            const domainsWithTags = domains.filter(domain => domain.tags && domain.tags.length > 0);
            const container = document.getElementById('domainsDisplay');
            
            if (domainsWithTags.length === 0) {
                container.innerHTML = '<div class="error">–î–æ–º–µ–Ω—ã —Å —Ç–µ–≥–∞–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }
            
            const html = domainsWithTags.map(domain => `
                <div class="domain-card">
                    <div class="domain-name">${domain.domain}</div>
                    ${domain.description ? `<div class="domain-description">${domain.description}</div>` : ''}
                    <div class="domain-tags">
                        ${domain.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                </div>
            `).join('');
            
            container.innerHTML = html;
        }
        
        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DomainStorage
        function testDomainStorage() {
            const info = document.getElementById('domainStorageInfo');
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ DomainStorage
                if (typeof DomainStorage === 'undefined') {
                    info.textContent = '–û–®–ò–ë–ö–ê: DomainStorage –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω';
                    return;
                }
                
                const storage = new DomainStorage();
                const domains = storage.getAllDomains();
                
                info.textContent = `DomainStorage —Ä–∞–±–æ—Ç–∞–µ—Ç:\n` +
                    `- –í—Å–µ–≥–æ –¥–æ–º–µ–Ω–æ–≤: ${domains.length}\n` +
                    `- –î–æ–º–µ–Ω—ã —Å —Ç–µ–≥–∞–º–∏: ${domains.filter(d => d.tags && d.tags.length > 0).length}\n` +
                    `- –í—Å–µ —Ç–µ–≥–∏: ${storage.getAllTags().join(', ')}`;
                
            } catch (error) {
                info.textContent = `–û–®–ò–ë–ö–ê DomainStorage: ${error.message}`;
            }
        }
        
        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DomainUI
        function testDomainUI() {
            const info = document.getElementById('domainUIInfo');
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ DomainUI
                if (typeof DomainUI === 'undefined') {
                    info.textContent = '–û–®–ò–ë–ö–ê: DomainUI –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω';
                    return;
                }
                
                const ui = new DomainUI();
                const domains = JSON.parse(localStorage.getItem('domains') || '[]');
                
                info.textContent = `DomainUI —Ä–∞–±–æ—Ç–∞–µ—Ç:\n` +
                    `- –î–æ–º–µ–Ω–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${domains.length}\n` +
                    `- –ú–µ—Ç–æ–¥ escapeHtml –¥–æ—Å—Ç—É–ø–µ–Ω: ${typeof ui.escapeHtml === 'function'}\n` +
                    `- –ú–µ—Ç–æ–¥ renderDomains –¥–æ—Å—Ç—É–ø–µ–Ω: ${typeof ui.renderDomains === 'function'}`;
                
            } catch (error) {
                info.textContent = `–û–®–ò–ë–ö–ê DomainUI: ${error.message}`;
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ CSS
        function checkCSS() {
            const info = document.getElementById('cssInfo');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∂–µ–Ω—ã –ª–∏ CSS —Ñ–∞–π–ª—ã
            const cssFiles = [
                'assets/css/main.css',
                'assets/css/sidebar.css',
                'assets/css/modal.css'
            ];
            
            let cssStatus = '–ü—Ä–æ–≤–µ—Ä–∫–∞ CSS —Ñ–∞–π–ª–æ–≤:\n';
            
            cssFiles.forEach(file => {
                const link = document.querySelector(`link[href="${file}"]`);
                if (link) {
                    cssStatus += `‚úÖ ${file} - –∑–∞–≥—Ä—É–∂–µ–Ω\n`;
                } else {
                    cssStatus += `‚ùå ${file} - –Ω–µ –Ω–∞–π–¥–µ–Ω\n`;
                }
            });
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∏–ª–∏ —Ç–µ–≥–æ–≤
            const testElement = document.createElement('div');
            testElement.className = 'domain-tags';
            testElement.innerHTML = '<span class="tag">—Ç–µ—Å—Ç</span>';
            document.body.appendChild(testElement);
            
            const computedStyle = window.getComputedStyle(testElement);
            const tagStyle = window.getComputedStyle(testElement.querySelector('.tag'));
            
            cssStatus += `\n–°—Ç–∏–ª–∏ —Ç–µ–≥–æ–≤:\n` +
                `- .domain-tags display: ${computedStyle.display}\n` +
                `- .tag background: ${tagStyle.backgroundColor}\n` +
                `- .tag color: ${tagStyle.color}\n` +
                `- .tag padding: ${tagStyle.padding}`;
            
            document.body.removeChild(testElement);
            
            info.textContent = cssStatus;
        }
        
        // –¢–µ—Å—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–≥–æ–≤
        function testTagDisplay() {
            const container = document.getElementById('tagDisplayTest');
            
            const testData = [
                { domain: 'test1.com', tags: ['—Ç–µ–≥1', '—Ç–µ–≥2', '—Ç–µ–≥3'] },
                { domain: 'test2.com', tags: [] },
                { domain: 'test3.com', tags: null },
                { domain: 'test4.com', tags: undefined },
                { domain: 'test5.com', tags: ['–æ–¥–∏–Ω —Ç–µ–≥'] }
            ];
            
            const html = testData.map(data => {
                const tagsHtml = data.tags && data.tags.length > 0 ? 
                    `<div class="domain-tags">${data.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}</div>` : 
                    '<div style="color: #999; font-size: 12px;">–ù–µ—Ç —Ç–µ–≥–æ–≤</div>';
                
                return `
                    <div class="domain-card">
                        <div class="domain-name">${data.domain}</div>
                        <div class="debug-info">–¢–µ–≥–∏: ${JSON.stringify(data.tags)}</div>
                        ${tagsHtml}
                    </div>
                `;
            }).join('');
            
            container.innerHTML = html;
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', function() {
            checkLocalStorage();
        });
    </script>
</body>
</html>

<!-- End of file: Spy/debug_tags.html -->
<!-- Last modified: 2025-01-22 -->
